<!-- predict.html (ML BONUS) -->
{% extends 'iris_app/base.html' %}
{% load static %}

{% block title %}ML Tahmin - Iris Sistemi{% endblock %}

{% block content %}

<h1>ðŸ¤– Makine Ã–ÄŸrenmesi - Iris TÃ¼rÃ¼ Tahminleme</h1>

<div class="div-info">
    <h3>Scikit-learn ile Tahmin</h3>
    <p>LÃ¼tfen Iris bitkisinin fiziksel Ã¶zelliklerini girerek tahmin algoritmasÄ±nÄ± seÃ§iniz. Sistem makine Ã¶ÄŸrenmesi modeli kullanarak tÃ¼rÃ¼ tahmin edecektir.</p>
</div>

<!-- ============= TAHMÄ°N FORMU ============= -->
<div class="card">
    <div class="card-header">
        <h2>Ã–lÃ§Ã¼mleri Girin</h2>
    </div>

    <div class="card-body">
        <form method="POST" novalidate>
            {% csrf_token %}

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                
                <div class="form-group">
                    <label for="id_sepal_length">{{ form.sepal_length.label }}</label>
                    {{ form.sepal_length }}
                </div>

                <div class="form-group">
                    <label for="id_sepal_width">{{ form.sepal_width.label }}</label>
                    {{ form.sepal_width }}
                </div>

                <div class="form-group">
                    <label for="id_petal_length">{{ form.petal_length.label }}</label>
                    {{ form.petal_length }}
                </div>

                <div class="form-group">
                    <label for="id_petal_width">{{ form.petal_width.label }}</label>
                    {{ form.petal_width }}
                </div>

            </div>

            <!-- ============= ALGORÄ°TMA SEÃ‡Ä°MÄ° ============= -->
            <div class="form-group" style="margin: 30px 0;">
                <label style="margin-bottom: 15px; display: block;">{{ form.algorithm.label }}</label>
                <div class="radio-group">
                    {% for radio_id, radio_value, radio_label in form.algorithm %}
                        <label>
                            <input type="radio" name="algorithm" value="{{ radio_value }}" id="{{ radio_id }}" required>
                            <span style="margin-left: 8px; font-weight: 500;">{{ radio_label }}</span>
                        </label>
                    {% endfor %}
                </div>
            </div>

            {% if error_message %}
                <div class="div-danger">
                    <p>{{ error_message }}</p>
                </div>
            {% endif %}

            <div class="btn-group">
                <button type="submit" class="btn btn-success">âœ… Tahmin Yap</button>
            </div>
        </form>
    </div>
</div>

<!-- ============= TAHMÄ°N SONUÃ‡LARI ============= -->
{% if prediction %}
    <div style="margin-top: 30px;">
        <div class="div-success">
            <h2>âœ¨ Tahmin Sonucu</h2>
            <div style="padding: 20px; background: white; border-radius: 8px; margin-top: 15px;">
                <h3 style="color: var(--success-color); font-size: 24px;">{{ prediction|upper }}</h3>
                {% if algorithm_name %}
                    <p><strong>KullanÄ±lan Algoritma:</strong> {{ algorithm_name }}</p>
                {% endif %}
                {% if confidence %}
                        <p><strong>GÃ¼ven Skoru:</strong> <span style="color: var(--success-color); font-weight: bold;">{{ confidence|default:'0'|floatformat:0 }}%</span></p>
div style="background: #ecf0f1; height: 30px; border-radius: 4px; overflow: hidden; margin: 10px 0;">
    <div class="progress-inner" data-width="{{ confidence|default:'0'|floatformat:0 }}%">
        <!-- iÃ§erik metni JS ile konulacak -->
    </div>
</div>

<style>
/* kÃ¼Ã§Ã¼k stil â€” istersen global CSS'e taÅŸÄ± */
.progress-inner{
  background: var(--success-color);
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  font-size: 12px;
  width: 0; /* baÅŸlangÄ±Ã§ */
  transition: width 300ms ease;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function(){
  const bar = document.querySelector('.progress-inner[data-width]');
  if(!bar) return;
  const w = bar.getAttribute('data-width') || '0%';
  bar.style.width = w;
  bar.textContent = w;
});
</script>
                    {% endif %}
            </div>
        </div>

        <!-- ============= Ä°RÄ°S TÃœRÃœ HAKKINDA BÄ°LGÄ° ============= -->
        <div class="div-highlight" style="margin-top: 20px;">
            <h3>ðŸ“š Iris TÃ¼rleri HakkÄ±nda</h3>
            <ul>
                <li><strong>Iris Setosa:</strong> KÃ¼Ã§Ã¼k boyutlu, dar yapraklÄ± Iris tÃ¼rÃ¼dÃ¼r.</li>
                <li><strong>Iris Versicolor:</strong> Orta boyutlu, yapraklarÄ± setosa ile virginica arasÄ±ndadÄ±r.</li>
                <li><strong>Iris Virginica:</strong> En bÃ¼yÃ¼k boyutlu, geniÅŸ yapraklÄ± Iris tÃ¼rÃ¼dÃ¼r.</li>
            </ul>
        </div>
    </div>
{% endif %}

<!-- ============= ALT BAÄžLANTILAR ============= -->
<div class="div-section" style="margin-top: 30px;">
    <h2>ðŸ”— HÄ±zlÄ± BaÄŸlantÄ±lar</h2>
    <ol>
        <li><a href="{% url 'iris_list' %}">TÃ¼m Iris Ã–rnekleri</a></li>
        <li><a href="{% url 'iris_search' %}">Arama YapÄ±n</a></li>
        <li><a href="{% url 'iris_create' %}">Yeni Ã–rnek Ekle</a></li>
        <li><a href="https://scikit-learn.org/" target="_blank">Scikit-learn Dokumentasyonu</a></li>
    </ol>
</div>

{% endblock %}